{% macro euclidea_distance() %}
sqrt(
    {% for i, term in encodings -%}
    power(TERM_{{ i }} - ({{ term }}), 2) + 
    {% endfor -%}
0)
{% endmacro %}
SELECT  face.id, face.locations, e.file_hash, {{ euclidea_distance() }} as distance 
FROM faces face
LEFT JOIN files e
ON face.file_id = e.id
HAVING distance < 0.5
ORDER BY distance ASC
LIMIT %(limit)s